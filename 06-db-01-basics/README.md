# Домашнее задание к занятию "6.1. Типы и структура СУБД"

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД 
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.

**Answer**

- **Электронные чеки в json виде** - document-oriented databases (NoSQL, Redis, MongoDB, ElasticSearch)
- **Склады и автомобильные дороги для логистической компании** - graph databases (ArrangoDB)
- **Генеалогические деревья** - hierarchical database model
- **Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации** - in-memory key-value databases (Memcached, Redis)
- **Отношения клиент-покупка для интернет-магазина** - relational database (SQL, Postgresql, MySQL, MS SQL, Oracle)


## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно 
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если 
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?

**Answer**

  - **Данные записываются на все узлы с задержкой до часа (асинхронная запись)** - A+P, A+P/E+L
  - **При сетевых сбоях, система может разделиться на 2 раздельных кластера** - A+P, A+P/E+? (не описано поведение при нормальной работе)
  - **Система может не прислать корректный ответ или сбросить соединение** - C+P, C+P/E+C


## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?

**Answer**  

>Согласно CAP теореме можно обеспечить только два из трех свойств распределенной системы. Практически во всех системах [необходимо реализовывать partition tolerance](https://odahale.com/you-cant-sacrifice-partition-tolerance/), поскольку компоненты распределенной системы используют сеть, допускающую потери связи. Иными словами в реальном мире не бывает настоящих систем CA. Это значит, что на выбор нам остается только одно свойство: либо consistency по принципам ACID, либо availability по принципам BASE, но не одновременно.
Однако в случае если мы сможем разделить нашу систему на подсистемы, то появится возможность построить одни подсистемы по принципам ACID, а другие по принципам BASE.


## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/). 
Что это за система? Какие минусы выбора данной системы?

**Answer**

>Redis.  
Минусы:
>- только master используется для записи, что делает его единой точкой отказа, и повышает нагрузку на него;
>- все данные загружаются в оперативную память, требуется большое количество ресурсов, возможна потеря данных в случае падения сервера;  
>- [реакция на истечение таймаута не гарантируется](https://redis.io/topics/notifications#:~:text=Keys%20with%20a%20time%20to,keys%20that%20are%20never%20accessed.), событие может быть сгенерировано не в момент истечения таймаута, а тогда, когда сервер это обнаружит.